<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Radar Bandar - Stockbit Trading Platform</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
          },
          colors: {
            bgPrimary: '#0f1419',
            bgSecondary: '#16181d',
            bgCard: '#1a1d23',
            bgHover: '#22252b',
            borderColor: '#2f3339',
            textPrimary: '#e7e9ea',
            textSecondary: '#8b949e',
            textMuted: '#6e7681',
            accentSuccess: '#0ecb81',
            accentDanger: '#f6465d',
            accentWarning: '#ffa500',
            accentInfo: '#3b82f6',
          }
        }
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer components {
      .btn-primary {
        @apply px-3 py-1.5 bg-accentInfo text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 font-semibold text-xs flex items-center gap-2 justify-center;
      }
      .btn-secondary {
        @apply px-3 py-1.5 bg-bgHover text-textPrimary border border-borderColor rounded-lg hover:bg-borderColor transition-colors duration-200 font-semibold text-xs flex items-center gap-2 justify-center;
      }
      .input-base {
        @apply bg-bgCard border border-borderColor text-textPrimary px-2 py-1.5 rounded-lg font-sans text-xs focus:outline-none focus:border-accentInfo focus:ring-1 focus:ring-accentInfo transition-all duration-200;
      }
      .card-base {
        @apply bg-bgCard border border-borderColor rounded-xl p-3 mb-2 overflow-hidden shadow-sm;
      }
      .table-header {
        @apply px-4 py-3 text-left font-semibold text-xs text-textMuted uppercase tracking-wider bg-bgSecondary sticky top-0 z-10 border-b border-borderColor whitespace-nowrap;
      }
      .table-cell {
        @apply px-4 py-3 text-xs text-textPrimary border-t border-borderColor whitespace-nowrap align-middle;
      }
      .badge {
        @apply px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide inline-block;
      }
      
      /* Utility for toggling visibility */
      .show {
        display: block !important;
      }
    }

    /* Mobile Responsive Table Cards */
    @media (max-width: 768px) {
        table, thead, tbody, th, td, tr {
            display: block;
        }

        thead tr {
            position: absolute;
            top: -9999px;
            left: -9999px;
        }

        tr {
            display: flex;
            flex-direction: column;
            @apply border border-borderColor rounded-xl bg-bgCard shadow-lg mb-4 relative overflow-hidden transition-colors;
        }

        /* Standard Row Styling */
        td {
            @apply flex justify-between items-center px-4 py-3 border-b border-borderColor/30 text-sm min-h-[44px];
        }

        td:last-child {
            border-bottom: none;
            @apply bg-bgSecondary/20;
        }

        /* Label Styling (Pseudo-element) */
        td:before {
            content: attr(data-label);
            @apply text-xs font-semibold text-textSecondary uppercase tracking-wider pr-4;
            flex-shrink: 0;
            max-width: 140px;
        }

        /* Symbol/Header Cell - Card Header Look */
        td[data-label="Saham"] {
            @apply bg-bgSecondary/60 border-b border-borderColor py-3 font-bold text-base;
            justify-content: space-between; /* Symbol Left, Confidence Right */
            gap: 8px;
            order: -1; /* Move to top of card */
        }
        
        td[data-label="Saham"]:before {
            display: none; /* Hide label for the header */
        }
        
        /* Ensure content inside cells aligns right */
        td > *:not(:first-child) {
            /* This targets the value content if it's the second child (after :before pseudo) 
               But :before is pseudo, so 'td > *' targets the actual DOM children.
               We want the content on the right. 
            */
        }
    }
    
    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    ::-webkit-scrollbar-track {
      @apply bg-bgSecondary;
    }
    ::-webkit-scrollbar-thumb {
      @apply bg-borderColor rounded hover:bg-textMuted transition-colors;
    }

    body {
        @apply bg-bgPrimary text-textPrimary font-sans antialiased;
    }
  </style>
    <style>
        .c-tab.active {
            color: rgb(56, 189, 248); /* text-accentInfo */
            border-bottom-color: rgb(56, 189, 248);
        }
    </style>
</head>

<body>
  <!-- Navbar -->
  <nav class="bg-bgSecondary border-b border-borderColor sticky top-0 z-50 backdrop-blur-md bg-opacity-90">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <!-- Logo -->
        <div class="flex-shrink-0 flex items-center gap-2">
          <span class="text-2xl">üêã</span>
          <span class="font-bold text-lg tracking-tight hidden sm:block">Radar Bandar</span>
        </div>

        <!-- Stats -->
        <div class="hidden md:flex flex-1 justify-center gap-8">
          <div class="flex flex-col items-center">
            <span class="text-xs font-semibold text-textMuted uppercase tracking-wider">Alerts</span>
            <span class="text-base font-bold text-textPrimary" id="total-alerts">0</span>
          </div>
          <div class="flex flex-col items-center">
            <span class="text-xs font-semibold text-textMuted uppercase tracking-wider">Win Rate</span>
            <span class="text-base font-bold text-accentSuccess" id="global-win-rate">0%</span>
          </div>
          <div class="flex flex-col items-center">
            <span class="text-xs font-semibold text-textMuted uppercase tracking-wider">Avg Profit</span>
            <span class="text-base font-bold text-accentSuccess" id="global-avg-profit">0%</span>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex items-center gap-3">
          <span id="market-regime" class="hidden md:inline-block px-3 py-1 bg-bgCard border border-borderColor rounded text-xs font-bold tracking-wide" style="display:none;">RANGING</span>
          <button id="webhook-config-btn" class="p-2 rounded-lg border border-borderColor hover:bg-bgHover transition-colors text-lg" title="Webhook Config">üîî</button>
          <button id="help-btn" class="p-2 rounded-lg border border-borderColor hover:bg-bgHover transition-colors text-lg" title="Help">‚ùì</button>
          <div class="flex items-center gap-2 px-3 py-1.5 bg-accentSuccess/10 border border-accentSuccess/20 rounded-lg text-accentSuccess text-sm font-semibold">
            <span class="w-1.5 h-1.5 bg-accentSuccess rounded-full animate-pulse"></span>
            <span>Live</span>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Filters -->
    <section class="mb-8">
      <div class="flex flex-wrap gap-3 items-center bg-bgCard p-4 rounded-xl border border-borderColor shadow-sm">
        <input type="text" id="search" class="input-base flex-1 min-w-[200px]" placeholder="üîç Cari Kode Saham..." />
        
        <select id="filter-action" class="input-base cursor-pointer">
          <option value="ALL">Semua Aksi</option>
          <option value="BUY">üü¢ Beli</option>
          <option value="SELL">üî¥ Jual</option>
        </select>
        
        <select id="filter-amount" class="input-base cursor-pointer">
          <option value="0">Semua Nilai</option>
          <option value="100000000">> 100 Jt</option>
          <option value="500000000">> 500 Jt</option>
          <option value="1000000000">> 1 M</option>
          <option value="5000000000">> 5 M</option>
        </select>
        
        <select id="filter-board" class="input-base cursor-pointer">
          <option value="ALL">Semua Board</option>
          <option value="RG">Regular</option>
          <option value="TN">Tunai</option>
          <option value="NG">Negosiasi</option>
        </select>

        <button id="clear-filters-btn" class="px-4 py-2 bg-accentDanger/10 text-accentDanger border border-accentDanger/30 rounded-lg hover:bg-accentDanger/20 transition-colors font-semibold text-sm hidden">‚úñ Clear</button>
        <button id="refresh-btn" class="btn-secondary">
            <span>üîÑ</span> Refresh
        </button>
      </div>
    </section>

    <!-- Grid Layout for Desktop -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        
        <!-- Whale Alerts Table -->
        <section class="card-base lg:col-span-2">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 gap-2">
                <div>
                    <h2 class="text-sm font-bold mb-0.5">üêã Alert Bandar</h2>
                    <p class="text-[10px] text-textSecondary">Real-time whale transactions</p>
                </div>
            </div>
            
            <div class="border border-borderColor rounded-lg overflow-hidden flex flex-col h-[500px]">
                <div class="overflow-auto flex-1 table-wrapper">
                    <table class="w-full text-left border-collapse min-w-full">
                        <thead class="bg-bgSecondary sticky top-0 left-0 right-0 z-10 w-full table-header-group">
                            <tr>
                                <th class="table-header">Waktu</th>
                                <th class="table-header">Saham</th>
                                <th class="table-header">Aksi</th>
                                <th class="table-header">Harga</th>
                                <th class="table-header text-right">Value</th>
                                <th class="table-header text-right">Volume</th>
                                <th class="table-header">Detail</th>
                            </tr>
                        </thead>
                        <tbody id="alerts-table-body" class="divide-y divide-borderColor">
                            <!-- Rows injected here -->
                        </tbody>
                    </table>
                </div>
                
                <div id="loading" class="p-8 text-center text-textSecondary bg-bgCard border-t border-borderColor">
                    <div class="animate-spin h-8 w-8 border-4 border-borderColor border-t-accentInfo rounded-full mx-auto mb-4"></div>
                    <p>Loading alerts...</p>
                </div>
                <div id="loading-more" class="p-4 text-center text-textSecondary text-sm border-t border-borderColor hidden bg-bgCard">
                    <div class="inline-block animate-spin h-4 w-4 border-2 border-borderColor border-t-accentInfo rounded-full mr-2"></div>
                    <span>Loading more...</span>
                </div>
                <div id="no-more-data" class="p-4 text-center text-textMuted text-sm italic border-t border-borderColor hidden bg-bgCard">
                    <p>üìä All data loaded</p>
                </div>
            </div>
        </section>

        <!-- Strategy Signals -->
        <section class="card-base">
            <div class="flex justify-between items-start mb-3">
                <div>
                    <h2 class="text-sm font-bold mb-0.5">üéØ Strategi Trading</h2>
                    <p class="text-[10px] text-textSecondary">AI-powered trading signals</p>
                </div>
                <div class="flex items-center gap-1 px-2 py-1 bg-bgSecondary border border-borderColor rounded text-[10px] font-semibold">
                    <span id="strategy-live-indicator" class="w-1.5 h-1.5 rounded-full bg-accentSuccess animate-pulse"></span>
                    <span id="strategy-connection-status">Connecting...</span>
                </div>
            </div>

            <div class="flex gap-2 mb-3 overflow-x-auto pb-1 border-b border-borderColor scrollbar-hide">
                <button class="px-2 py-1 text-xs font-semibold rounded hover:bg-bgHover text-textSecondary hover:text-textPrimary transition-colors strategy-tab active border-b-2 border-accentInfo" data-strategy="ALL">Semua</button>
                <button class="px-2 py-1 text-xs font-semibold rounded hover:bg-bgHover text-textSecondary hover:text-textPrimary transition-colors strategy-tab" data-strategy="VOLUME_BREAKOUT">üöÄ Volume</button>
                <button class="px-2 py-1 text-xs font-semibold rounded hover:bg-bgHover text-textSecondary hover:text-textPrimary transition-colors strategy-tab" data-strategy="MEAN_REVERSION">‚Ü©Ô∏è Mean Rev</button>
                <button class="px-2 py-1 text-xs font-semibold rounded hover:bg-bgHover text-textSecondary hover:text-textPrimary transition-colors strategy-tab" data-strategy="FAKEOUT_FILTER">üõ°Ô∏è Fakeout</button>
                <button class="px-2 py-1 text-xs font-semibold rounded hover:bg-bgHover text-textSecondary hover:text-textPrimary transition-colors strategy-tab" data-strategy="HISTORY">üìú History</button>
            </div>

            <div class="border border-borderColor rounded-lg overflow-hidden flex flex-col h-[400px]">
                <div class="overflow-auto flex-1 table-wrapper">
                    <table class="w-full text-left min-w-full" id="signals-table">
                        <thead class="bg-bgSecondary sticky top-0 z-10 w-full table-header-group">
                            <tr>
                                <th class="table-header">Waktu</th>
                                <th class="table-header">Saham</th>
                                <th class="table-header">Strategi</th>
                                <th class="table-header">Aksi</th>
                                <th class="table-header">Harga</th>
                                <th class="table-header">Change</th>
                                <th class="table-header">Result</th>
                            </tr>
                        </thead>
                        <tbody id="signals-table-body" class="divide-y divide-borderColor">
                            <!-- Rows will be injected here -->
                        </tbody>
                    </table>
                </div>
                <div id="signals-loading" class="p-8 text-center text-textSecondary hidden border-t border-borderColor bg-bgCard">
                    <div class="animate-spin h-8 w-8 border-4 border-borderColor border-t-accentInfo rounded-full mx-auto mb-4"></div>
                    <p>Loading signals...</p>
                </div>
                <div id="signals-placeholder" class="p-12 text-center text-textSecondary flex flex-col items-center justify-center h-full">
                    <span class="text-4xl block mb-3 opacity-50">üì°</span>
                    <p>Waiting for trading signals...</p>
                </div>
            </div>
        </section>

        <!-- Running Positions -->
        <section class="card-base">
            <div class="flex justify-between items-start mb-3">
                <div>
                    <h2 class="text-sm font-bold mb-0.5">üíº Posisi Aktif</h2>
                    <p class="text-[10px] text-textSecondary">Active trading positions</p>
                </div>
            </div>
            <div class="border border-borderColor rounded-lg overflow-hidden flex flex-col h-[400px]">
                <div class="overflow-auto flex-1 table-wrapper">
                    <table class="w-full text-left min-w-full" id="positions-table">
                        <thead class="bg-bgSecondary sticky top-0 z-10 w-full table-header-group">
                            <tr>
                                <th class="table-header">Saham</th>
                                <th class="table-header">Strategi</th>
                                <th class="table-header">Entry Time</th>
                                <th class="table-header text-right">Entry Price</th>
                                <th class="table-header text-right">P&L %</th>
                                <th class="table-header">Status</th>
                            </tr>
                        </thead>
                        <tbody id="positions-table-body" class="divide-y divide-borderColor">
                            <!-- Rows will be injected here -->
                        </tbody>
                    </table>
                </div>
                <div id="positions-loading" class="p-8 text-center text-textSecondary hidden border-t border-borderColor bg-bgCard">
                    <div class="animate-spin h-8 w-8 border-4 border-borderColor border-t-accentInfo rounded-full mx-auto mb-4"></div>
                    <p>Loading positions...</p>
                </div>
                <div id="positions-placeholder" class="p-12 text-center text-textSecondary flex flex-col items-center justify-center h-full">
                    <span class="text-4xl block mb-3 opacity-50">üíº</span>
                    <p>No active positions</p>
                </div>
            </div>
        </section>

        <!-- Position History -->
        <section class="card-base lg:col-span-2">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 gap-2">
                <div>
                    <h2 class="text-sm font-bold mb-0.5">üìú Riwayat Trading</h2>
                    <p class="text-[10px] text-textSecondary">Completed trade history</p>
                </div>
                <div class="flex flex-wrap gap-2">
                    <select id="history-strategy" class="bg-bgSecondary border border-borderColor text-textPrimary text-xs rounded-lg px-2 py-1.5 focus:outline-none focus:border-accentInfo">
                        <option value="ALL">Semua Strategi</option>
                        <option value="VOLUME_BREAKOUT">Volume Breakout</option>
                        <option value="MEAN_REVERSION">Mean Reversion</option>
                        <option value="FAKEOUT_FILTER">Fakeout Filter</option>
                    </select>
                    <select id="history-status" class="bg-bgSecondary border border-borderColor text-textPrimary text-xs rounded-lg px-2 py-1.5 focus:outline-none focus:border-accentInfo">
                        <option value="ALL">Semua Status</option>
                        <option value="WIN">Win</option>
                        <option value="LOSS">Loss</option>
                    </select>
                    <button id="history-refresh-btn" class="p-1.5 rounded-lg border border-borderColor hover:bg-bgHover transition-transform">
                        üîÑ
                    </button>
                    <!-- Missing limit select, but maybe it's fine without it for now unless specific logic needs it -->
                    <select id="history-limit" class="hidden">
                        <option value="20">20</option>
                    </select>
                </div>
            </div>
            <div class="border border-borderColor rounded-lg overflow-hidden flex flex-col h-[400px]">
                <div class="overflow-auto flex-1 table-wrapper">
                    <table class="w-full text-left min-w-full" id="history-table">
                        <thead class="bg-bgSecondary sticky top-0 z-10 w-full table-header-group">
                            <tr>
                                <th class="table-header">Saham</th>
                                <th class="table-header">Strategi</th>
                                <th class="table-header">Outcome</th>
                                <th class="table-header text-right">Entry</th>
                                <th class="table-header text-right">Exit</th>
                                <th class="table-header text-right">P&L</th>
                                <th class="table-header text-right">Duration</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body" class="divide-y divide-borderColor">
                            <!-- Rows will be injected here -->
                        </tbody>
                    </table>
                </div>
                <div id="history-loading" class="p-8 text-center text-textSecondary hidden border-t border-borderColor bg-bgCard">
                    <div class="animate-spin h-8 w-8 border-4 border-borderColor border-t-accentInfo rounded-full mx-auto mb-4"></div>
                    <p>Loading history...</p>
                </div>
                <!-- Loading More Indicator -->
                 <div id="history-loading-more" class="p-4 text-center text-textSecondary text-sm border-t border-borderColor hidden bg-bgCard">
                    <div class="inline-block animate-spin h-4 w-4 border-2 border-borderColor border-t-accentInfo rounded-full mr-2"></div>
                    <span>Loading more...</span>
                </div>
                <div id="history-no-more-data" class="p-4 text-center text-textMuted text-sm italic border-t border-borderColor hidden bg-bgCard">
                    <p>üìä End of history</p>
                </div>
                 <div id="history-placeholder" class="p-12 text-center text-textSecondary flex flex-col items-center justify-center h-full">
                    <span class="text-4xl block mb-3 opacity-50">üìú</span>
                    <p>No trading history</p>
                </div>
            </div>
        </section>

        <!-- Accumulation/Distribution Summary -->
        <section class="card-base lg:col-span-2">
            <div class="flex justify-between items-start mb-3">
                <div>
                    <h2 class="text-sm font-bold mb-0.5">üìä Aktivitas Bandar (24h)</h2>
                    <p class="text-[10px] text-textSecondary">Top whale activities</p>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Accumulation Table -->
                <div>
                    <h3 class="flex items-center gap-2 text-sm font-semibold mb-2">
                        üìà Top 20 Akumulasi
                        <span id="accumulation-count" class="px-1.5 py-0.5 bg-bgSecondary border border-borderColor rounded text-[10px]">0</span>
                    </h3>
                    <div class="border border-borderColor rounded-lg overflow-hidden h-[400px] overflow-auto flex flex-col">
                        <div class="overflow-auto flex-1 table-wrapper">
                             <table class="w-full text-left min-w-full" id="accumulation-table">
                                <thead class="bg-bgSecondary sticky top-0 z-10 w-full table-header-group">
                                    <tr>
                                        <th class="table-header">Saham</th>
                                        <th class="table-header text-right">Beli %</th>
                                        <th class="table-header text-right">Net Value</th>
                                        <th class="table-header text-right">Total Value</th>
                                    </tr>
                                </thead>
                                <tbody id="accumulation-table-body" class="divide-y divide-borderColor">
                                    <!-- Rows will be injected here -->
                                </tbody>
                            </table>
                        </div>
                        <div id="accumulation-placeholder" class="p-8 text-center text-textSecondary hidden border-t border-borderColor bg-bgCard">
                            <span class="text-3xl block mb-2 opacity-50">üìà</span>
                            <p>No accumulation data</p>
                        </div>
                    </div>
                </div>

                <!-- Distribution Table -->
                <div>
                    <h3 class="flex items-center gap-2 text-sm font-semibold mb-2">
                        üìâ Top 20 Distribusi
                        <span id="distribution-count" class="px-1.5 py-0.5 bg-bgSecondary border border-borderColor rounded text-[10px]">0</span>
                    </h3>
                    <div class="border border-borderColor rounded-lg overflow-hidden h-[400px] overflow-auto flex flex-col">
                        <div class="overflow-auto flex-1 table-wrapper">
                           <table class="w-full text-left min-w-full" id="distribution-table">
                                <thead class="bg-bgSecondary sticky top-0 z-10 w-full table-header-group">
                                    <tr>
                                        <th class="table-header">Saham</th>
                                        <th class="table-header text-right">Jual %</th>
                                        <th class="table-header text-right">Net Value</th>
                                        <th class="table-header text-right">Total Value</th>
                                    </tr>
                                </thead>
                                <tbody id="distribution-table-body" class="divide-y divide-borderColor">
                                    <!-- Rows will be injected here -->
                                </tbody>
                            </table>
                        </div>
                        <div id="distribution-placeholder" class="p-8 text-center text-textSecondary hidden border-t border-borderColor bg-bgCard">
                            <span class="text-3xl block mb-2 opacity-50">üìâ</span>
                            <p>No distribution data</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Market Intelligence -->
        <section class="card-base lg:col-span-2">
             <div class="flex justify-between items-start mb-3">
                <div>
                    <h2 class="text-sm font-bold mb-0.5">üß† Market Intelligence</h2>
                    <p class="text-[10px] text-textSecondary">Real-time market conditions and statistics</p>
                </div>
             </div>

             <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-3">
                 <!-- Regime Card -->
                 <div class="bg-bgSecondary border border-borderColor rounded-xl p-6 flex flex-col items-center text-center">
                    <div class="text-xs uppercase tracking-wider text-textMuted font-bold mb-2">KONDISI PASAR</div>
                    <div class="text-2xl font-bold text-accentInfo mb-2" id="intel-regime">STABIL</div>
                    <div class="text-sm text-textSecondary" id="intel-regime-desc">Menganalisis kondisi pasar...</div>
                 </div>

                 <!-- Baseline Stats -->
                 <div class="bg-bgSecondary border border-borderColor rounded-xl p-6 flex flex-col justify-center">
                    <div class="text-xs uppercase tracking-wider text-textMuted font-bold mb-4 text-center">STATISTIK DASAR</div>
                    <div class="space-y-3 text-sm">
                        <div class="flex justify-between items-center border-b border-borderColor pb-2">
                            <span class="text-textSecondary">Rata-rata Vol:</span>
                            <strong id="b-avg-vol" class="text-textPrimary">-</strong>
                        </div>
                        <div class="flex justify-between items-center pt-1">
                            <span class="text-textSecondary">Std Dev:</span>
                            <strong id="b-std-dev" class="text-textPrimary">-</strong>
                        </div>
                    </div>
                 </div>

                 <!-- Pressure Bar -->
                 <div class="bg-bgSecondary border border-borderColor rounded-xl p-6 flex flex-col justify-center">
                    <div class="text-xs uppercase tracking-wider text-textMuted font-bold mb-4 text-center">TEKANAN JUAL/BELI</div>
                    <div class="relative h-6 bg-bgCard rounded-full overflow-hidden mb-3">
                        <div class="absolute inset-0 flex">
                            <div id="buy-pressure-fill" class="h-full bg-accentSuccess transition-all duration-500" style="width: 50%"></div>
                            <div id="sell-pressure-fill" class="h-full bg-accentDanger transition-all duration-500" style="width: 50%"></div>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs font-bold">
                        <span id="buy-pressure-pct" class="text-accentSuccess">50% BELI</span>
                        <span id="sell-pressure-pct" class="text-accentDanger">50% JUAL</span>
                    </div>
                 </div>
             </div>

             <div class="bg-bgSecondary border border-borderColor rounded-xl p-6">
                 <h4 class="font-bold text-sm mb-4 text-textMuted uppercase tracking-wider">Pola Terkini</h4>
                 <div id="pattern-list" class="space-y-2 max-h-[200px] overflow-y-auto pr-2">
                    <div class="text-sm text-textSecondary italic p-4 text-center bg-bgCard rounded border border-borderColor border-dashed">Menunggu pola...</div>
                 </div>
             </div>
        </section>

        <!-- AI Analysis -->
        <section class="card-base lg:col-span-2">
            <div class="flex justify-between items-start mb-3">
                <div>
                    <h2 class="text-sm font-bold mb-0.5">ü§ñ AI Pattern Analysis</h2>
                    <p class="text-[10px] text-textSecondary">Real-time AI-powered pattern detection</p>
                </div>
                <div class="px-2 py-0.5 bg-accentInfo/10 text-accentInfo border border-accentInfo/20 rounded text-[10px] font-bold uppercase" id="llm-status">Ready</div>
            </div>

            <div class="flex gap-2 mb-3 overflow-x-auto pb-1 border-b border-borderColor scrollbar-hide">
                <button class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-bgHover text-textPrimary hover:bg-accentInfo hover:text-white transition-colors tab-btn active whitespace-nowrap" data-type="accumulation">üìà Akumulasi</button>
                <button class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-bgHover text-textPrimary hover:bg-accentInfo hover:text-white transition-colors tab-btn whitespace-nowrap" data-type="anomalies">‚ö° Anomali</button>
                <button class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-bgHover text-textPrimary hover:bg-accentInfo hover:text-white transition-colors tab-btn whitespace-nowrap" data-type="timing">‚è∞ Timing</button>
                <button class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-bgHover text-textPrimary hover:bg-accentInfo hover:text-white transition-colors tab-btn whitespace-nowrap" data-type="symbol">üéØ Symbol</button>
                <button class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-bgHover text-textPrimary hover:bg-accentInfo hover:text-white transition-colors tab-btn whitespace-nowrap" data-type="custom">‚úçÔ∏è Custom</button>
            </div>
            
            <div id="symbol-input-container" class="mb-4 hidden">
                <input type="text" id="symbol-input" class="input-base w-full max-w-sm uppercase" placeholder="Enter stock code (e.g., BBCA)" maxlength="4" />
            </div>

             <!-- Custom Prompt Input -->
            <div id="custom-prompt-container" class="mb-4 hidden space-y-4">
                <textarea id="custom-prompt-input" class="input-base w-full resize-y h-32"
                placeholder="Tanyakan apa saja tentang data di database... Contoh: 'Saham mana yang paling banyak akumulasi hari ini?' atau 'Analisis pola BBCA dalam 24 jam terakhir'"></textarea>

                <div class="flex flex-wrap gap-4">
                    <div class="flex-1 min-w-[200px]">
                        <label class="block text-xs text-textSecondary mb-1">Symbols (opsional):</label>
                        <input type="text" id="custom-symbols-input" class="input-base w-full uppercase" placeholder="e.g., BBCA,TLKM,BMRI" />
                    </div>

                    <div class="flex-1 min-w-[200px]">
                        <label class="block text-xs text-textSecondary mb-1">Include Data:</label>
                        <select id="custom-data-type" class="input-base w-full cursor-pointer">
                            <option value="alerts,regimes">Alerts + Regimes</option>
                            <option value="alerts,regimes,patterns">+ Patterns</option>
                            <option value="alerts,regimes,patterns,signals">+ Signals</option>
                            <option value="alerts">Alerts Only</option>
                            <option value="regimes">Regimes Only</option>
                            <option value="patterns">Patterns Only</option>
                            <option value="signals">Signals Only</option>
                        </select>
                    </div>

                    <div class="w-[100px]">
                        <label class="block text-xs text-textSecondary mb-1">Hours Back:</label>
                        <input type="number" id="custom-hours-input" class="input-base w-full" value="24" min="1" max="168" />
                    </div>
                </div>
            </div>

            <div id="llm-stream-output" class="p-8 text-center text-textSecondary border border-borderColor border-dashed rounded-lg bg-bgSecondary/30 min-h-[200px] flex flex-col items-center justify-center prose prose-invert max-w-none">
                <div class="flex flex-col items-center">
                    <span class="text-4xl mb-4 opacity-70">üß†</span>
                    <p class="font-medium">Click "Start Analysis" to begin AI real-time analysis</p>
                </div>
            </div>

            <div class="mt-4 flex gap-3">
                <button id="start-analysis-btn" class="btn-primary">
                    <span>‚ñ∂</span> Start Analysis
                </button>
                <button id="stop-analysis-btn" class="btn-secondary hidden">
                    <span>‚èπ</span> Stop
                </button>
            </div>
        </section>

    </div>
  </main>

  <!-- Help Modal -->
  <div id="help-modal" class="fixed inset-0 z-[100] hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
        <!-- Overlay -->
        <div class="fixed inset-0 bg-black/75 transition-opacity" aria-hidden="true" id="help-modal-overlay"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        
        <!-- Modal Content -->
        <div class="inline-block align-bottom bg-bgCard rounded-xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full border border-borderColor">
            <div class="bg-bgCard px-6 pt-6 pb-4">
                <div class="flex justify-between items-center mb-6 border-b border-borderColor pb-4">
                    <h3 class="text-xl font-bold text-textPrimary" id="modal-title">üéØ Panduan Whale Radar</h3>
                    <button class="modal-close text-textSecondary hover:text-textPrimary focus:outline-none text-2xl" id="modal-close">&times;</button>
                </div>
                
                <div class="modal-body text-sm text-textSecondary space-y-6 max-h-[60vh] overflow-y-auto pr-2">
                    <section class="space-y-2">
                        <h3 class="text-base font-bold text-textPrimary">üìñ Apa itu Whale Radar?</h3>
                        <p>Dashboard real-time yang memantau transaksi saham besar ("whale" / ikan paus) di pasar modal Indonesia.
                          Sistem ini mendeteksi aktivitas fund besar yang bisa menjadi indikator pergerakan harga.</p>
                    </section>
            
                    <section class="space-y-2">
                        <h3 class="text-base font-bold text-textPrimary">üêã Whale Alerts Feed</h3>
                        <p>Menampilkan transaksi besar secara real-time dengan fitur filter:</p>
                        <ul class="list-disc pl-5 space-y-1">
                          <li><strong class="text-textPrimary">Symbol</strong>: Cari kode saham tertentu (contoh: BBCA, TLKM)</li>
                          <li><strong class="text-textPrimary">Action</strong>: Filter BUY (akumulasi) atau SELL (distribusi)</li>
                          <li><strong class="text-textPrimary">Min Value</strong>: Filter berdasarkan nilai transaksi minimum</li>
                          <li><strong class="text-textPrimary">Board Type</strong>: RG (Regular), TN (Tunai), NG (Negosiasi)</li>
                        </ul>
                    </section>

                    <section class="space-y-2">
                        <h3 class="text-base font-bold text-textPrimary">üé® Code Warna</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                          <div class="flex items-center gap-2 p-2 bg-bgSecondary rounded border border-borderColor">
                            <span class="badge bg-green-900/40 text-accentSuccess">BUY</span>
                            <span class="text-xs">Akumulasi / Pembelian besar</span>
                          </div>
                          <div class="flex items-center gap-2 p-2 bg-bgSecondary rounded border border-borderColor">
                            <span class="badge bg-red-900/40 text-accentDanger">SELL</span>
                            <span class="text-xs">Distribusi / Penjualan besar</span>
                          </div>
                        </div>
                    </section>
                </div>
            </div>
            <div class="bg-bgSecondary px-6 py-4 flex flex-row-reverse border-t border-borderColor">
                <button type="button" class="btn-primary" id="modal-got-it">Mengerti!</button>
            </div>
        </div>
    </div>
  </div>

  <!-- Webhook Modal -->
  <div id="webhook-modal" class="fixed inset-0 z-[100] hidden" aria-labelledby="webhook-modal-title" role="dialog" aria-modal="true">
    <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-black/75 transition-opacity" aria-hidden="true"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        
        <div class="inline-block align-bottom bg-bgCard rounded-xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full border border-borderColor">
            <div class="bg-bgCard px-6 pt-6 pb-4">
                <div class="flex justify-between items-center mb-6 border-b border-borderColor pb-4">
                    <h3 class="text-xl font-bold text-textPrimary">üîî Konfigurasi Webhook</h3>
                    <button class="text-textSecondary hover:text-textPrimary focus:outline-none text-2xl" id="webhook-modal-close">&times;</button>
                </div>

                <div class="space-y-6">
                    <!-- List Section -->
                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <h4 class="text-sm font-bold text-textSecondary uppercase tracking-wider">Active Webhooks</h4>
                            <button id="add-webhook-btn" class="btn-primary text-xs py-1.5 px-3">
                                ‚ûï Add New
                            </button>
                        </div>
                        
                        <div class="border border-borderColor rounded-lg overflow-hidden">
                            <table class="w-full text-left">
                                <thead class="bg-bgSecondary">
                                    <tr>
                                        <th class="px-4 py-2 text-xs font-semibold text-textMuted uppercase">Name</th>
                                        <th class="px-4 py-2 text-xs font-semibold text-textMuted uppercase">URL</th>
                                        <th class="px-4 py-2 text-xs font-semibold text-textMuted uppercase">Status</th>
                                        <th class="px-4 py-2 text-xs font-semibold text-textMuted uppercase text-right">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="webhook-list-body" class="divide-y divide-borderColor text-sm">
                                    <!-- Rows injected via JS -->
                                </tbody>
                            </table>
                            <div id="webhook-loading" class="p-4 text-center text-textSecondary hidden">
                                <div class="inline-block animate-spin h-4 w-4 border-2 border-borderColor border-t-accentInfo rounded-full mr-2"></div>
                                Loading...
                            </div>
                            <div id="webhook-placeholder" class="p-8 text-center text-textMuted text-sm">
                                No webhooks configured
                            </div>
                        </div>
                    </div>

                    <!-- Form Section -->
                    <div id="webhook-form-section" class="hidden bg-bgSecondary/50 p-4 rounded-lg border border-borderColor border-dashed">
                        <h4 class="text-sm font-bold text-textPrimary mb-4" id="webhook-form-title">Add New Webhook</h4>
                        <form id="webhook-form" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs text-textSecondary mb-1">Name</label>
                                    <input type="text" id="webhook-name" class="input-base w-full" placeholder="e.g. Discord Alerts" required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-xs text-textSecondary mb-1">Webhook URL</label>
                                    <input type="url" id="webhook-url" class="input-base w-full" placeholder="https://discord.com/api/webhooks/..." required>
                                </div>
                            </div>
                            
                            <div class="flex items-center gap-2">
                                <input type="checkbox" id="webhook-enabled" class="rounded bg-bgCard border-borderColor text-accentInfo focus:ring-accentInfo" checked>
                                <label for="webhook-enabled" class="text-sm text-textPrimary">Enable this webhook</label>
                            </div>

                            <div class="flex gap-2 justify-end pt-2">
                                <button type="button" id="cancel-webhook-btn" class="btn-secondary text-xs">Cancel</button>
                                <button type="submit" id="save-webhook-btn" class="btn-primary text-xs">Save Webhook</button>
                            </div>
                        </form>
                    </div>

                    <div class="bg-bgSecondary/30 p-3 rounded text-xs text-textSecondary">
                        <p class="mb-1 font-bold">üîî How it works:</p>
                        <p>Webhooks allow you to receive real-time notifications for whale alerts and strategy signals directly to your Discord, Slack, or Telegram.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
  </div>

  <!-- Candle Details Modal -->
  <div id="candle-modal" class="fixed inset-0 z-[100] hidden" aria-labelledby="candle-modal-title" role="dialog" aria-modal="true">
    <div class="fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity" aria-hidden="true" id="candle-modal-overlay"></div>
    
    <div class="fixed inset-0 z-10 overflow-y-auto">
      <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
        <div class="relative transform overflow-hidden rounded-lg bg-bgCard border border-borderColor text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl" onclick="event.stopPropagation()">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 border-b border-borderColor bg-bgSecondary/30">
                <h3 id="candle-modal-title" class="text-lg font-bold text-textPrimary">üìâ Market Details</h3>
                <button type="button" id="candle-modal-close" class="text-textSecondary hover:text-textPrimary transition-colors rounded p-1 hover:bg-white/5">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <div class="p-6">
                <!-- Timeframe Tabs -->
                <div class="flex flex-wrap gap-2 mb-6 border-b border-borderColor">
                    <button class="c-tab px-4 py-2 text-sm font-medium text-textSecondary hover:text-textPrimary border-b-2 border-transparent transition-colors active" data-timeframe="5m">5 Min</button>
                    <button class="c-tab px-4 py-2 text-sm font-medium text-textSecondary hover:text-textPrimary border-b-2 border-transparent transition-colors" data-timeframe="15m">15 Min</button>
                    <button class="c-tab px-4 py-2 text-sm font-medium text-textSecondary hover:text-textPrimary border-b-2 border-transparent transition-colors" data-timeframe="1h">1 Hour</button>
                    <button class="c-tab px-4 py-2 text-sm font-medium text-textSecondary hover:text-textPrimary border-b-2 border-transparent transition-colors" data-timeframe="1d">Daily</button>
                </div>

                <!-- Candle Table -->
                <div class="overflow-x-auto table-wrapper max-h-[500px] border border-borderColor rounded-lg">
                    <table class="min-w-full divide-y divide-borderColor">
                        <thead class="bg-bgSecondary sticky top-0 z-10">
                            <tr>
                                <th scope="col" class="py-3 px-4 text-left text-xs font-medium text-textSecondary uppercase tracking-wider">Time</th>
                                <th scope="col" class="py-3 px-4 text-right text-xs font-medium text-textSecondary uppercase tracking-wider">Open</th>
                                <th scope="col" class="py-3 px-4 text-right text-xs font-medium text-textSecondary uppercase tracking-wider">High</th>
                                <th scope="col" class="py-3 px-4 text-right text-xs font-medium text-textSecondary uppercase tracking-wider">Low</th>
                                <th scope="col" class="py-3 px-4 text-right text-xs font-medium text-textSecondary uppercase tracking-wider">Close</th>
                                <th scope="col" class="py-3 px-4 text-right text-xs font-medium text-textSecondary uppercase tracking-wider">Volume</th>
                            </tr>
                        </thead>
                        <tbody id="candle-list-body" class="bg-bgCard divide-y divide-borderColor text-sm text-textPrimary">
                            <!-- JS injected rows -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Followup Analysis Modal -->
  <div id="followup-modal" class="fixed inset-0 z-[100] hidden" aria-labelledby="followup-modal-title" role="dialog" aria-modal="true">
    <div class="fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity" aria-hidden="true"></div>

    <div class="fixed inset-0 z-10 overflow-y-auto">
      <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
        <div class="relative transform overflow-hidden rounded-lg bg-bgCard border border-borderColor text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl" onclick="event.stopPropagation()">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 border-b border-borderColor bg-bgSecondary/30">
                <div>
                    <h3 class="text-lg font-bold text-textPrimary">üêã Whale Followup Analysis</h3>
                    <div class="flex items-center gap-2 text-sm text-textSecondary mt-1">
                        <span id="followup-symbol" class="font-bold text-accentInfo text-base">CODE</span>
                        <span class="text-xs">‚Ä¢</span>
                        <span>Trigger: <span id="followup-trigger-price" class="font-mono text-textPrimary">Rp 0</span></span>
                    </div>
                </div>
                <button type="button" id="followup-close" class="text-textSecondary hover:text-textPrimary transition-colors rounded p-1 hover:bg-white/5">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <div id="followup-data" class="p-6 max-h-[70vh] overflow-y-auto w-full">
                 <!-- Content injected by JS -->
                 <div class="flex justify-center p-8">
                    <div class="animate-spin h-8 w-8 border-4 border-borderColor border-t-accentInfo rounded-full"></div>
                 </div>
            </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center text-textSecondary text-sm border-t border-borderColor mt-8">
    <p>Whale Analysis System &copy; 2025</p>
  </footer>

  <script type="module" src="js/app.js?v=7"></script>
</body>
</html>